function dC_dq = rotmat_quat_jacobian(q)
    % 输入：q-四元数[4×1] = [q0; q1; q2; q3]
    % 输出：雅可比dC/dq[3×4]（旋转矩阵每一行对4个四元数分量的偏导）
    q0 = q(1); q1 = q(2); q2 = q(3); q3 = q(4);
    
    % 直接计算3×4矩阵（每行对应旋转矩阵的一行，每列对应q0/q1/q2/q3）
%     dC_dq = [
%         % 旋转矩阵第1行对q0/q1/q2/q3的偏导
%         0,          2*q2,       2*q1,       -2*q0*q3 + 2*q1*q2;
%         % 旋转矩阵第2行对q0/q1/q2/q3的偏导
%         0,          2*q3,       -2*q0*q3 + 2*q1*q2, 2*q2;
%         % 旋转矩阵第3行对q0/q1/q2/q3的偏导
%         -2*q2,      2*q3,       2*q0*q2 + 2*q1*q3, 2*q0*q1 - 2*q2*q3
%     ];
%     dC_dq = [
%         2*q0, -2*q3,  2*q2, -2*q1;  % dC(1,1)/dq, dC(1,2)/dq, dC(1,3)/dq（列）
%         2*q3,  2*q0, -2*q1, -2*q2;  % dC(2,1)/dq, dC(2,2)/dq, dC(2,3)/dq
%         2*q2,  2*q1,  2*q0, -2*q3   % dC(3,1)/dq, dC(3,2)/dq, dC(3,3)/dq
%     ];
    dC_dq = [
        % 第一行：旋转矩阵第一行对q0, q1, q2, q3的偏导数
        0,                  0,                  -4*q2,              -4*q3;
        % 第二行：旋转矩阵第二行对q0, q1, q2, q3的偏导数
        2*(-q3 + q3),       2*(q2 + q2),        2*(q1 + q1),        2*(q0 - q0);
        % 第三行：旋转矩阵第三行对q0, q1, q2, q3的偏导数
        2*(q2 - q2),        2*(q3 + q3),        2*(q0 - q0),        2*(q1 + q1)];
end